#!/usr/bin/env bash

set -eu
source ./deps


# Check for install

    HOMEBREW_PREFIX=$(getHomebrewPrefix)
    if [ -d "$HOMEBREW_PREFIX" ]; then 
        PATH=$PATH:$HOMEBREW_PREFIX/bin; 
    else 
        message info "brew not installed, skipping installation of apps"
        exit 0
    fi;


# Install apps

    message info "Installing apps, fonts & quicklook pluginsâ€¦"

    apps=(
        google-chrome
        firefox
        sourcetree
        transmit
        rectangle
        vlc
        transmission
        macdown
    )

    brew install --cask --no-quarantine "${apps[@]}" --appdir=/Applications


# Install QuickLook plugins (https://github.com/sindresorhus/quick-look-plugins)

    ql=(
        # these are now handled by the syntax-highlight cask
        # qlstephen
        # qlmarkdown
        # quicklook-json
        # qlprettypatch
        quicklook-csv
        webpquicklook
        quicklookase
    )

    brew install --no-quarantine "${ql[@]}"

    qlcask=(
        syntax-highlight
        qlmarkdown
        qlvideo
    )

    brew install --cask --no-quarantine "${qlcask[@]}"


# Install utilities

    utilities=(
        ffmpeg
        gifski
    )

    brew install --no-quarantine ${utilities[@]}


# Install fonts

    fonts=(
      font-ibm-plex-mono
      font-ibm-plex-sans
      font-ibm-plex-serif
    )
    brew install --cask --no-quarantine ${fonts[@]}


# Sublime

    brew install --cask --no-quarantine sublime-text --appdir=/Applications

    sublime-update-prefs
    sublime-icon
